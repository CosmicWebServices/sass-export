#!/usr/bin/env node

let sassExport = require('../dist').default;
let fs = require('fs');
let path = require('path');
let minimist = require('minimist');

let options = minimist(process.argv.slice(2), {
  alias: {
    o: 'output',
    h: 'help'
  }
});

let filePath = options._[0];

if (!filePath || options.help) {
  fs.createReadStream(path.resolve(__dirname, 'help.txt'))
    .pipe(process.stdout)
    .on('close', () => {
      throw Error('Error reading help');
    });
  return;
}

if (!options.output) {
  options.output = filePath + '.json';
}

let result = sassExport({
  filePath
});

fs.writeFileSync(options.output, JSON.stringify(result.getArray()));
console.log(`${options.output} was generated, go check it out!`);